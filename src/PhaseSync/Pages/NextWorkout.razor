@page "/nextworkout"
@attribute [Authorize]
@if (TAOConnected)
{
    <MudCard>
        <MudCardHeader>
            <CardHeaderContent>
                <MudText Typo="Typo.h6">Upcoming workout</MudText>
            </CardHeaderContent>
        </MudCardHeader>
        <MudCardContent>
            <PlotlyChart @bind-Config="config" @bind-Layout="layout" Data="data" @ref="chart"/>
            @if(Workout is not null)
            {
                <MudText>@Workout!.ToString()</MudText>
            }
            else
            {
                <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-7" />
            }
        </MudCardContent>
        <MudCardActions>
            @if (SettingsComplete)
            {
                <MudButton
                    Variant="Variant.Text"
                    Color="Color.Primary"
                    Disabled="@(Workout is null)"
                    OnClick="@SendToPolar">Push to Polar Flow</MudButton>
            }
            else
            {
                <MudAlert Severity="Severity.Error">
                    Please complete all settings on the
                    <MudLink Href="/settings" Typo="Typo.body2" Color="Color.Inherit"><b>settings</b></MudLink>
                    page in order to upload this workout to Polar Flow.
                </MudAlert>
                <MudButton Variant="Variant.Text" Color="Color.Primary" Disabled="true">Push to Polar Flow</MudButton>
            }

        </MudCardActions>
    </MudCard>
    
} else
{
    <MudAlert Severity="Severity.Error">
        It looks like you have not yet granted PhaseSync access to your TrainAsONE Workouts.
        Please fix this in the <MudLink Href="/settings" Typo="Typo.body2" Color="Color.Inherit"><b>settings</b></MudLink>.
    </MudAlert>
}
